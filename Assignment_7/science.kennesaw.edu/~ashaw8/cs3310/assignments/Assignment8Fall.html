<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:a="http://rainier.kennesaw.edu/2006/Assignment" xmlns:cwi="http://rainier.kennesaw.edu/2006/CourseWideInformation"><head xmlns="">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type"><meta name="Author" content="Alan Shaw"><title>CS 3310 - Spring 2014</title><link rel="stylesheet" href="OldStyleVariant.css" type="text/css"></head><body><div xmlns="" id="header"><img class="headerimage" src="database.png" altsrc="5 cubes inscribed in an icosohedron.  Each cube is a different color" height="150">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CS 3310 - Spring 2014</div>
<table border=0 cellspacing=0 cellpadding=0>
<tr>
<td align=left width=60></td>
<td>

    <h1>Assignment #8: Database Implementation Pt. 2</h1>
<p>
For this assignment you will build the remaining tables you need for your ShoppingCart website.  But this website will not be the Fun Cake Store website.  It will be a website that sells a different set of products that you come up with.  This website will also include a "Check-Out" tab which will require the user to create an account, then give the user a summation of their purchase, and then send the user an email confirmation of their purchase.  You site will also include an "Admin" tab where you can log in and review a list of all completed purchases.
<p>For this assignment, you will be using a new zipped template file with the additional C# code in it for your website's new functionality.  To get started, download the <a href="ShoppingCartV2.zip">ShoppingCartV2.zip</a> archived project folder.  Unzip the file and place the <b>ShoppingCartV2</b> folder into your Projects folder inside of your Visual Studio 2010 folder.
<p>
Once you have done that, you can start up Visual Studio 2010, and then go to the File menu, and choose "Open" and then "Project/Solution", and then find the ShoppingCartV2 folder, and open it, and then select the "ShoppingCartV2.sln" file you will see underneath another ShoppingCartV2 folder, and then click on the "Open" button to open up your ShoppingCartV2 website project.
<p>

<p>Next, you need to build the following additional Tables:
<p>
<ul>
<li>Options
<li>Intersections
<li>PurchaseOrders
<li>LineItems
<li>OptionAssociations
</ul>
<p>
The first of these tables is the Options table that will list a set of options that your products might offer that can either increase the price (if they are accessories) or decrease the price (if they are discounts).
<p>
The Options table will be implemented as an independent table from the Products table.  This approach allows for a set of options to be used by more than one product, but this approach also requires an additional Intersections table be created to identify which products offer which options.
<p> 
For instance, on the Fun Cake Store website, the first tab had 3 different Cakes that could be ordered and their product IDs were 1, 2 and 3.  If an Options table existed for the Fun Cake Store website, it might have the following data:
<p>
<img src=CakeDataTBL1.png>
<p>
This data lists 2 optional accessories for cakes, the first of which is to "Personalize With Name" your cake for an additional $1.99, and the second of which is to add "Extra Frosting" for an additional $0.99.  The data also list 3 optional discounts for cakes. The "No Frosting" discount takes $1.00 off of the price, and the "Have Coupon" discount takes $0.50 off the price, and the "Member Discount" takes $1.00 off of the price. 
<p>
With this Options table data, you might also have the following Intersections table data:
<p>
<img src=CakeDataTBL2.png>
<p>
This table data links the first cake product with the first 2 optional accessories, and it also links the second cake product with the first 2 optional accessories.  Then it links the third cake product with the 3 optional discounts.
<p>
In Part 2 of this assignment you will be given the code you need to make your options data show up on your website.  But for Part 1, all you are supposed to do is build your tables and that the code will use to access your tables.
<p>

<hr>
<center>The Options Table</center>
<p>To create the <u>Options</u> table open up the ShoppingCardDB.mdf item by clicking on the arrow next to it, and then right-click on the Tables folder and select "Add New Table".  Next, you will create the following fields in this  table, and notice that the OptionsID field is a Primary Key, and it is an "Identity Specification" field.  Also notice that no fields "Allow Nulls" this time: 
<p>
<img src=ShoppingCart14.png>
<p>
Now save your Table and give it the name <u>Options</u>.  
<p>
<img src=ShoppingCart15.png>
<p>
Next, you will create a new Model for your table by right-clicking  on the Models folder in the Solution Explorer and select Add and then New Item. Select the Data category and select the ADO.NET Entity Data Model template. Then give your data model the name <u>OptionsModel.edmx</u>:
<p>
<img src=ShoppingCart16.png width=600>
<p>
After you click the Add button, the Entity Data Model Wizard appears, and under the line "What should the model contain?" select the Generate from database option.
<p>
<img src=KSUCornerDB4.png>
<p>
Then in the next screen, in the drop-down box under the line "Which data connection should your application use to connnect to the database?", choose ShoppingCartDB.mdf, and note that the "entity connection settings" shown at the bottom should say "ShoppingCartDBEntities2".  If you don't see a "2", take special note of the number you do see because you will need to use that number later.
<p>
<img src=ShoppingCart17.png width=600>
<p>
After you click the Next button, you will go to the "Choose Your Database Objects" screen, where you must expand the Tables node, and select the Options table:
<p>
<img src=ShoppingCart18.png width=600>
<p>
When you click on the finish button, you will have a OptionsModel.edmx file in your Models folder, and you will see the Option record as follows.
<p>
<img src=ShoppingCart19.png>
<p>
Now you are finished with creating the Options table.
<hr>
<center>The Intersections Table</center>
<p>To create the <u>Intersections</u> table go into the Server Explorer and open up the Tables folder inside of the ShoppingCartDB database.  To add the Intersections table to the database, right click on the Tables folder and select "Add New Table".  Next, you will create the following fields in this table, and notice that both fields are Primary Keys, and neither is an "Identity Specification" field.  And also note that neither field is marked as "Allow Nulls": 
<p>
<img src=ShoppingCart20.png>
<p>
Now save your Table and give it the name <u>Intersections</u>.  
<p>
<img src=ShoppingCart21.png>
<p>
Next, you will create a new Model for your table by right-clicking  on the Models folder in the Solution Explorer and select Add and then New Item. Select the Data category and select the ADO.NET Entity Data Model template. Then give your data model the name <u>IntersectionsModel.edmx</u>:
<p>
<img src=ShoppingCart22.png width=600>
<p>
After you click the Add button, the Entity Data Model Wizard appears, and under the line "What should the model contain?" select the Generate from database option.
<p>
<img src=KSUCornerDB4.png>
<p>
Then in the next screen, in the drop-down box under the line "Which data connection should your application use to connnect to the database?", choose ShoppingCartDB.mdf, and note that the "entity connection settings" shown at the bottom should say "ShoppingCartDBEntities3".  If you don't see a "3", take special note of the number you do see because you will need to use that number later.
<p>
<img src=ShoppingCart23.png width=600>
<p>
After you click the Next button, you will go to the "Choose Your Database Objects" screen, where you must expand the Tables node, and select the Intersections table only, and not the other tables:
<p>
<img src=ShoppingCart24.png width=600>
<p>
When you click on the finish button, you will have a IntersectionsModel.edmx file in your Models folder, and you will see the Intersection record as follows.
<p>
<img src=ShoppingCart25.png>

<p>
Now you are finished with creating the Intersections table.
<hr>
<center>The PurchaseOrders Table</center>
<p>To create the <u>PurchaseOrders</u> table go into the Server Explorer and open up the Tables folder inside of the ShoppingCartDB database.  To add the PurchaseOrders table to the database, right click on the Tables folder and select "Add New Table".  Next, you will create the following fields in this table, and notice that the OrderID field is a Primary Key, and it is an "Identity Specification" field. Also notice that no fields "Allow Nulls" this time:
<p>
<img src=ShoppingCart26.png>
<p>
Now save your Table and give it the name <u>PurchaseOrders</u>.  
<p>
<img src=ShoppingCart27.png>
<p>
Next, you will create a new Model for your table by right-clicking  on the Models folder in the Solution Explorer and select Add and then New Item. Select the Data category and select the ADO.NET Entity Data Model template. Then give your data model the name <u>PurchaseOrdersModel.edmx</u>:
<p>
<img src=ShoppingCart28.png width=600>
<p>
After you click the Add button, the Entity Data Model Wizard appears, and under the line "What should the model contain?" select the Generate from database option.
<p>
<img src=KSUCornerDB4.png>
<p>
Then in the next screen, in the drop-down box under the line "Which data connection should your application use to connnect to the database?", choose ShoppingCartDB.mdf, and note that the "entity connection settings" shown at the bottom should say "ShoppingCartDBEntities4".  If you don't see a "4", take special note of the number you do see because you will need to use that number later.
<p>
<img src=ShoppingCart29.png width=600>
<p>
After you click the Next button, you will go to the "Choose Your Database Objects" screen, where you must expand the Tables node, and select the PurchaseOrders table only, and not the other tables:
<p>
<img src=ShoppingCart30.png width=600>
<p>
When you click on the finish button, you will have a PurchaseOrdersModel.edmx file in your Models folder, and you will see the PurchaseOrder record as follows.
<p>
<img src=ShoppingCart31.png>

<p>
Now you are finished with creating the PurchaseOrders table.
<hr>
<center>The LineItems Table</center>
<p>To create the <u>LineItems</u> table go into the Server Explorer and open up the Tables folder inside of the ShoppingCartDB database.  To add the LineItems table to the database, right click on the Tables folder and select "Add New Table".  Next, you will create the following fields in this table, and notice that both the OrderID field and the LineNumber field are Primary Keys, and neither one is an "Identity Specification" field. Also notice that no fields "Allow Nulls" this time:
<p>
<img src=ShoppingCart32.png>
<p>
Now save your Table and give it the name <u>LineItems</u>.  
<p>
<img src=ShoppingCart33.png>
<p>
Next, you will create a new Model for your table by right-clicking  on the Models folder in the Solution Explorer and select Add and then New Item. Select the Data category and select the ADO.NET Entity Data Model template. Then give your data model the name <u>LineItemsModel.edmx</u>:
<p>
<img src=ShoppingCart34.png width=600>
<p>
After you click the Add button, the Entity Data Model Wizard appears, and under the line "What should the model contain?" select the Generate from database option.
<p>
<img src=KSUCornerDB4.png>
<p>
Then in the next screen, in the drop-down box under the line "Which data connection should your application use to connnect to the database?", choose ShoppingCartDB.mdf, and note that the "entity connection settings" shown at the bottom should say "ShoppingCartDBEntities5".  If you don't see a "5", take special note of the number you do see because you will need to use that number later.
<p>
<img src=ShoppingCart35.png width=600>
<p>
After you click the Next button, you will go to the "Choose Your Database Objects" screen, where you must expand the Tables node, and select the LineItems table only, and not the other tables:
<p>
<img src=ShoppingCart36.png width=600>
<p>
When you click on the finish button, you will have a LineItemsModel.edmx file in your Models folder, and you will see the LineItem record as follows.
<p>
<img src=ShoppingCart37.png>


<p>
Now you are finished with creating the LineItems table.
<hr>
<center>The OptionAssociations Table</center>
<p>To create the <u>OptionAssociations</u> table go into the Server Explorer and open up the Tables folder inside of the ShoppingCartDB database.  To add the OptionAssociations table to the database, right click on the Tables folder and select "Add New Table".  Next, you will create the following fields in this table, and notice that all three fields are Primary Keys, and none of them is an "Identity Specification" field.  And also note that no field is marked as "Allow Nulls": 
<p>
<img src=ShoppingCart38.png>
<p>
Now save your Table and give it the name <u>OptionAssociations</u>.  
<p>
<img src=ShoppingCart39.png>
<p>
Next, you will create a new Model for your table by right-clicking  on the Models folder in the Solution Explorer and select Add and then New Item. Select the Data category and select the ADO.NET Entity Data Model template. Then give your data model the name <u>OptionAssociationsModel.edmx</u>:
<p>
<img src=ShoppingCart40.png width=600>
<p>
After you click the Add button, the Entity Data Model Wizard appears, and under the line "What should the model contain?" select the Generate from database option.
<p>
<img src=KSUCornerDB4.png>
<p>
Then in the next screen, in the drop-down box under the line "Which data connection should your application use to connnect to the database?", choose ShoppingCartDB.mdf, and note that the "entity connection settings" shown at the bottom should say "ShoppingCartDBEntities6".  If you don't see a "6", take special note of the number you do see because you will need to use that number later.
<p>
<img src=ShoppingCart41.png width=600>
<p>
After you click the Next button, you will go to the "Choose Your Database Objects" screen, where you must expand the Tables node, and select the OptionAssociations table only, and not the other tables:
<p>
<img src=ShoppingCart42.png width=600>
<p>
When you click on the finish button, you will have a OptionAssociationsModel.edmx file in your Models folder, and you will see the OptionAssociation record as follows.
<p>
<img src=ShoppingCart43.png>

<p>
Now you are finished with creating the OptionAssociations table.

<p>
<hr>
<p>
If you ran into a problem with any of your Entity names when you were creating your table models, you will have to take an extra step.  The Entity names should end with a number, either "ShoppingCartDBEntities2", "ShoppingCartDBEntities3", "ShoppingCartDBEntities4", "ShoppingCartDBEntities5", or "ShoppingCartDBEntities6".  But if you ran into a problem and had to do that step multiple times, the number may have increased each time.  That means your numbers may be off.  For example if this happened while you were creating "ShoppingCartDBEntities4", then it may have become "5", and "5" may have become "6", and "6 may have become "7".  If this did happen, you will have to determine which numbers are off, and then you need to go into your Controllers folder in the <b>Solution Explorer</b>, and then double-click on the PartialCode.cs file to open it up.  <p>
If any of your numbers are off, you will have to change the Entity names for those values in the PartialCode.cs file.  Search for the Entity names that you know are off, starting with the highest numbers first and fix them one by one.  For example if "4", "5" and "6" became "5", "6" and "7" as described above, first change everywhere you see "ShoppingCartDBEntities6" to "ShoppingCartDBEntities7" (there will be more than one of these), and then change everywhere you see "ShoppingCartDBEntities5" to "ShoppingCartDBEntities6" (there will be more than one of these), and then change everywhere you see "ShoppingCartDBEntities4" to "ShoppingCartDBEntities5" (there will be more than one of these).  When you are all done, save and close this file.
<p>
<hr>
<p>
After you have created your new tables, you should have seven tables in all listed here in alphabetical order:
<p>
<ul>
<li>Customers
<li>Intersections
<li>LineItems
<li>OptionAssociations
<li>Options
<li>Products
<li>PurchaseOrders
</ul>
<p>
Some of these tables have foreign keys in them, so the next thing you must do is set up the foreign key relationships as follows:
<p>
<ul>
<li>In the <b>Intersections</b> table the <u>ProductID</u> field is a foreign key to the same field in the <b>Products</b> table.  And in the same <b>Intersections</b> table the <u>OptionID</u> field is a foreign key to the same field in the <b>Options</b> table.
<p>
<li>In the <b>LineItems</b> table the <u>OrderID</u> field is a foreign key to the same field in the <b>PurchaseOrders</b> table.  And in the same <b>LineItems</b> table the <u>ProductID</u> field is a foreign key to the same field in the <b>Products</b> table.
<p>
<li>In the <b>OpenAssociations</b> table the <u>OrderID</u> field is a foreign key to the same field in the <b>PurchaseOrders</b> table.  And in the same <b>OpenAssociations</b> table the <u>ProductID</u> field is a foreign key to the same field in the <b>Products</b> table.  And in the same <b>OpenAssociations</b> table the <u>OptionID</u> field is a foreign key to the same field in the <b>Options</b> table.
<p>
<li>In the <b>PurchaseOrders</b> table the <u>CustomerID</u> field is a foreign key to the <u>ID</u> field in the <b>Customers</b> table.
</ul>
<p>
<hr>
<p>
Now you are ready to modify your HomeController.cs file. You first will need to change the siteHeading field so that your website heading is in that field.  Then you will need to modify the three tab arrays below that field and the one optionsColumnHeading array so that the include the lables that describe your product categories and your option categories.  For instance, you should replace the "Single Layer Options" label in the tabHeadings with the tab headings for your product, and you should replace "1-Layer" in the tabLabels with the tab labels for your product, and you should add to where you see "Tab1Orders" in the tabViews with the strings for your other tab view names like "Tab2Orders" and "Tab3Orders", and where you see "Single Layer Options" in the optionsColumnHeadings with the names of the options available for your products on each tab.
<p>
Next, right below that array, there is a taxRate variable that you can leave as is, or set it to whatever value you think is appropriate.  And below that is a return email address that will go into emails that are sent by the website after a user has made a purchase.  This is just a fake email address, but you should change it to something that will be a fake email address for your website.  Notice that the address contains the words "funcakestore", but that should change since your Shopping cart does should not be selling cakes:
<p>
<pre>
        // The tax rate is 5%
        decimal taxRate = 0.05M;

        // Email address of the company that will be in the "From" box of the confirmation message sent
        string websiteEmail = "order@funcakestore.com";
</pre>
<p>
<hr>
<p>
After finishing the above tasks, and after adding data to your tables that is appropriate for your webstore, you should be able to run your website with the Options features implemented for each tab without errors.  One of the new features in this website that you did not have in last assignment is your Admin page.  To access your admin page you will be required to log in, and in order to log in you need to create an account for yourself.  To do this, go to the Log On page and at the top of the page you will see a sentence with a "Register" link.  Click on that link and then fill in the information to create an account for yourself.  Note that you will have to create an account with a password of at least six characters.
<p>
When you have created the account, you should be click on the "Admin" view and then see that you can now access and review the following 5 tables over the website, and with the last three you can also alter their contents:
<p>
<ol>
<li>Customer Accounts</li>
<li>Purchase Orders</li>
<li>Products Table</li>
<li>Options Table</li>
<li>Intersections Table</li>
</ol>
<p>
<hr>
<p>
Now for your final task, <u>you must be sure to put a welcoming message and an image appropriate</u> to your website on your front page by placing the code for that message and image into your Index() method near the top of your HomeController.cs.<p>
Along with that, <u>you must put a message that lists all of the users in your group </u>on the About page by placing the code for that message into your About() method.  You can use the <a href="aboutus.jpg">aboutus.jpg</a> image that has been provided for you, or if you have an image that is more appropriate, feel free to use that.
<hr>
<p>
Now, if you have gotten everything to work, you are finally done.
<p>

<hr>
<p>
<h2>Deliverables</h2>
<p>Zip your ShoppingCartV2 project folder (you may have to delete your old zipped ShoppingCartV2.zip file first if it is in the same folder) and then turn in your newly zipped file:</p>
    <ul>
        <li> <code>ShoppingCartV2.zip</code> </li>
    </ul>

<p>You only need to turn in one ZIP file per team with all of your product views in it, but I encourage each member of your team to go through the steps of getting this code working on their own computer in order to get a little familiar with Visual Studio.

<p>Turn in your file by uploading it as an attachment to Assignment 07 in the Homework Assignments section
of the class website in D2L.  Be sure to press the Submit button AFTER your attachment
has been uploaded.  (If you press the Submit button before your attachment has been uploaded, you
will not be able to upload the attachment later.  If that happens email it to me at 
    <a href="mailto:ashaw8@kennesaw.edu">ashaw8@kennesaw.edu</a>.)</p>

    <table class="important"><tr><td>
            Assignment Due: May 1, 2014
            by 11:59 PM
        </td></tr></table>
   
</td>
</tr>
</table>

</body></html>